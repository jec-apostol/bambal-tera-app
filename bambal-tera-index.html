<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bambal Tera Laundry Shop - Loyalty Rewards">
    <meta name="theme-color" content="#0EA5E9">
    <title>Bambal Tera Laundry Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .animate-fadeIn { animation: fadeIn 0.3s ease-in; }
        .animate-bounce { animation: bounce 0.5s ease-in-out 3; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script>
        const { useState, useEffect } = React;
        const { Sparkles, Gift, Percent, QrCode, ScanLine, Users, Settings, LogOut, Plus, Minus, Trash2 } = lucide;

        function App() {
            const [view, setView] = useState('login');
            const [currentUser, setCurrentUser] = useState(null);
            const [phone, setPhone] = useState('');
            const [name, setName] = useState('');
            const [pass, setPass] = useState('');
            const [customers, setCustomers] = useState({});
            const [showQR, setShowQR] = useState(false);
            const [scan, setScan] = useState('');
            const [reward, setReward] = useState({ show: false, type: '' });

            useEffect(() => {
                const data = localStorage.getItem('bambal-customers');
                if (data) setCustomers(JSON.parse(data));
            }, []);

            const save = (data) => {
                localStorage.setItem('bambal-customers', JSON.stringify(data));
                setCustomers(data);
            };

            const login = () => {
                const p = phone.replace(/\D/g, '');
                if (!p || p.length < 10) return alert('Valid phone needed');
                const all = { ...customers };
                if (!all[p]) {
                    if (!name.trim()) return alert('Enter your name');
                    all[p] = { name, phone: p, stamps: 0, totalDiscounts: 0, totalFree: 0 };
                    save(all);
                }
                setCustomers(all);
                setCurrentUser(p);
                setView('customer');
            };

            const add = (p) => {
                const c = customers[p];
                if (c && c.stamps < 10) {
                    const s = c.stamps + 1;
                    save({ ...customers, [p]: { ...c, stamps: s } });
                    if (s === 5 || s === 10) {
                        setReward({ show: true, type: s === 10 ? 'free' : 'discount' });
                        setTimeout(() => setReward({ show: false, type: '' }), 2000);
                    }
                }
            };

            const remove = (p) => {
                const c = customers[p];
                if (c && c.stamps > 0) save({ ...customers, [p]: { ...c, stamps: c.stamps - 1 } });
            };

            const claim = (p, type) => {
                const c = customers[p];
                save({
                    ...customers,
                    [p]: {
                        ...c,
                        stamps: 0,
                        totalDiscounts: type === 'discount' ? c.totalDiscounts + 1 : c.totalDiscounts,
                        totalFree: type === 'free' ? c.totalFree + 1 : c.totalFree
                    }
                });
                setReward({ show: false, type: '' });
            };

            const del = (p) => {
                if (confirm('Delete?')) {
                    const u = { ...customers };
                    delete u[p];
                    save(u);
                }
            };

            if (view === 'login') {
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-6 flex items-center justify-center' },
                    React.createElement('div', { className: 'max-w-md w-full space-y-4' },
                        React.createElement('div', { className: 'bg-white rounded-3xl shadow-2xl p-8' },
                            React.createElement('div', { className: 'text-center mb-8' },
                                React.createElement('div', { className: 'inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-500 to-cyan-600 rounded-full mb-4' },
                                    React.createElement('svg', { className: 'w-10 h-10 text-white', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
                                        React.createElement('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: 'M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10' })
                                    )
                                ),
                                React.createElement('h1', { className: 'text-3xl font-bold text-gray-800 mb-2' }, 'Bambal Tera'),
                                React.createElement('h2', { className: 'text-xl font-semibold text-gray-700 mb-1' }, 'Laundry Shop'),
                                React.createElement('p', { className: 'text-gray-600' }, 'Customer Login')
                            ),
                            React.createElement('div', { className: 'space-y-4' },
                                React.createElement('input', {
                                    type: 'tel',
                                    value: phone,
                                    onChange: (e) => setPhone(e.target.value),
                                    placeholder: '09171234567',
                                    className: 'w-full px-4 py-3 border-2 rounded-xl focus:border-blue-500 focus:outline-none'
                                }),
                                React.createElement('input', {
                                    type: 'text',
                                    value: name,
                                    onChange: (e) => setName(e.target.value),
                                    placeholder: 'Your name (first time)',
                                    className: 'w-full px-4 py-3 border-2 rounded-xl focus:border-blue-500 focus:outline-none'
                                }),
                                React.createElement('button', {
                                    onClick: login,
                                    className: 'w-full bg-gradient-to-r from-blue-500 to-cyan-600 text-white py-4 rounded-xl font-semibold shadow-lg'
                                }, 'Login / Register')
                            )
                        ),
                        React.createElement('button', {
                            onClick: () => setView('admin-login'),
                            className: 'w-full bg-gray-800 text-white py-3 rounded-xl font-medium'
                        }, 'Admin Login')
                    )
                );
            }

            if (view === 'admin-login') {
                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-gray-800 to-black p-6 flex items-center justify-center' },
                    React.createElement('div', { className: 'bg-white rounded-3xl shadow-2xl p-8 max-w-md' },
                        React.createElement('div', { className: 'text-center mb-8' },
                            React.createElement('div', { className: 'inline-flex items-center justify-center w-20 h-20 bg-gray-800 rounded-full mb-4' },
                                React.createElement(Settings, { size: 40, className: 'text-white' })
                            ),
                            React.createElement('h1', { className: 'text-3xl font-bold mb-2' }, 'Admin Access'),
                            React.createElement('p', { className: 'text-gray-600' }, 'Password: admin123')
                        ),
                        React.createElement('div', { className: 'space-y-4' },
                            React.createElement('input', {
                                type: 'password',
                                value: pass,
                                onChange: (e) => setPass(e.target.value),
                                placeholder: 'Password',
                                className: 'w-full px-4 py-3 border-2 rounded-xl focus:outline-none',
                                onKeyPress: (e) => e.key === 'Enter' && pass === 'admin123' && setView('admin')
                            }),
                            React.createElement('button', {
                                onClick: () => pass === 'admin123' ? setView('admin') : alert('Wrong!'),
                                className: 'w-full bg-gray-800 text-white py-4 rounded-xl font-semibold'
                            }, 'Login'),
                            React.createElement('button', {
                                onClick: () => setView('login'),
                                className: 'w-full bg-gray-100 py-3 rounded-xl'
                            }, 'Back')
                        )
                    )
                );
            }

            if (view === 'customer' && currentUser && customers[currentUser]) {
                const c = customers[currentUser];
                const st = c.stamps === 10 ? { t: 'Free Load Ready!', col: 'green' } :
                          c.stamps === 5 ? { t: '30% Off Ready!', col: 'blue' } :
                          c.stamps > 5 ? { t: `${10-c.stamps} more for FREE`, col: 'purple' } :
                          { t: `${5-c.stamps} more for 30% OFF`, col: 'amber' };

                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-6' },
                    React.createElement('div', { className: 'max-w-md mx-auto' },
                        React.createElement('div', { className: 'flex justify-between mb-6' },
                            React.createElement('div', null,
                                React.createElement('h2', { className: 'text-2xl font-bold' }, c.name),
                                React.createElement('p', { className: 'text-gray-600' }, c.phone)
                            ),
                            React.createElement('button', {
                                onClick: () => { setView('login'); setCurrentUser(null); },
                                className: 'bg-white p-3 rounded-xl shadow'
                            }, React.createElement(LogOut, { size: 20 }))
                        ),
                        React.createElement('div', { className: 'bg-white rounded-3xl shadow-2xl p-8' },
                            React.createElement('div', { className: 'text-center mb-6' },
                                React.createElement('button', {
                                    onClick: () => setShowQR(!showQR),
                                    className: 'bg-gradient-to-r from-blue-500 to-cyan-600 text-white px-6 py-3 rounded-xl font-semibold inline-flex items-center gap-2'
                                }, React.createElement(QrCode, { size: 20 }), showQR ? 'Hide QR' : 'Show QR')
                            ),
                            showQR && React.createElement('div', { className: 'bg-white p-6 rounded-2xl border-4 border-blue-500 mb-6' },
                                React.createElement('div', { className: 'bg-gray-900 text-white text-center py-8 rounded-xl font-mono text-2xl font-bold' }, c.phone),
                                React.createElement('p', { className: 'text-center text-sm text-gray-600 mt-3' }, 'Show to staff')
                            ),
                            React.createElement('div', { className: 'grid grid-cols-5 gap-3 mb-6' },
                                [...Array(10)].map((_, i) =>
                                    React.createElement('div', {
                                        key: i,
                                        className: `aspect-square rounded-xl border-2 flex items-center justify-center ${
                                            i < c.stamps ? (i < 5 ? 'bg-gradient-to-br from-blue-400 to-cyan-500 shadow-lg' : 'bg-gradient-to-br from-purple-400 to-pink-500 shadow-lg') : 'bg-gray-50 border-dashed'
                                        } ${(i === 4 || i === 9) ? 'ring-2 ring-yellow-400' : ''}`
                                    }, i < c.stamps && React.createElement(Sparkles, { size: 20, className: 'text-white' }))
                                )
                            ),
                            React.createElement('div', {
                                className: `bg-gradient-to-r ${st.col === 'green' ? 'from-green-500 to-emerald-600' : st.col === 'blue' ? 'from-blue-500 to-cyan-600' : st.col === 'purple' ? 'from-purple-500 to-pink-600' : 'from-amber-500 to-orange-600'} text-white rounded-xl p-4 text-center mb-6`
                            }, React.createElement('p', { className: 'font-bold text-lg' }, st.t)),
                            c.stamps === 10 && React.createElement('button', {
                                onClick: () => claim(currentUser, 'free'),
                                className: 'w-full bg-green-500 text-white py-4 rounded-xl font-semibold mb-3 flex items-center justify-center gap-2'
                            }, React.createElement(Gift, { size: 20 }), 'Claim FREE Load!'),
                            c.stamps === 5 && React.createElement('button', {
                                onClick: () => claim(currentUser, 'discount'),
                                className: 'w-full bg-blue-500 text-white py-4 rounded-xl font-semibold mb-3 flex items-center justify-center gap-2'
                            }, React.createElement(Percent, { size: 20 }), 'Claim 30% OFF!')
                        )
                    ),
                    reward.show && React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
                        React.createElement('div', { className: 'bg-white rounded-3xl p-8 mx-4 text-center animate-bounce' },
                            React.createElement('div', { className: `inline-flex items-center justify-center w-20 h-20 ${reward.type === 'free' ? 'bg-green-500' : 'bg-blue-500'} rounded-full mb-4` },
                                reward.type === 'free' ? React.createElement(Gift, { size: 40, className: 'text-white' }) : React.createElement(Percent, { size: 40, className: 'text-white' })
                            ),
                            React.createElement('h2', { className: 'text-3xl font-bold mb-2' }, 'Reward Unlocked!'),
                            React.createElement('p', { className: 'text-gray-600' }, reward.type === 'free' ? 'FREE load!' : '30% OFF!')
                        )
                    )
                );
            }

            if (view === 'admin') {
                const tot = Object.keys(customers).length;
                const stps = Object.values(customers).reduce((s, c) => s + c.stamps, 0);
                const disc = Object.values(customers).reduce((s, c) => s + c.totalDiscounts, 0);
                const fr = Object.values(customers).reduce((s, c) => s + c.totalFree, 0);

                return React.createElement('div', { className: 'min-h-screen bg-gradient-to-br from-gray-800 to-black p-6' },
                    React.createElement('div', { className: 'max-w-6xl mx-auto' },
                        React.createElement('div', { className: 'flex justify-between mb-6' },
                            React.createElement('div', null,
                                React.createElement('h1', { className: 'text-3xl font-bold text-white' }, 'Bambal Tera'),
                                React.createElement('p', { className: 'text-gray-400' }, 'Admin Dashboard')
                            ),
                            React.createElement('button', {
                                onClick: () => { setView('login'); setPass(''); },
                                className: 'bg-red-500 text-white px-6 py-3 rounded-xl flex items-center gap-2'
                            }, React.createElement(LogOut, { size: 20 }), 'Logout')
                        ),
                        React.createElement('div', { className: 'grid grid-cols-4 gap-4 mb-6' },
                            React.createElement('div', { className: 'bg-blue-500 rounded-2xl p-6 text-white' },
                                React.createElement(Users, { size: 32, className: 'mb-2' }),
                                React.createElement('p', { className: 'text-3xl font-bold' }, tot),
                                React.createElement('p', null, 'Customers')
                            ),
                            React.createElement('div', { className: 'bg-purple-500 rounded-2xl p-6 text-white' },
                                React.createElement(Sparkles, { size: 32, className: 'mb-2' }),
                                React.createElement('p', { className: 'text-3xl font-bold' }, stps),
                                React.createElement('p', null, 'Stamps')
                            ),
                            React.createElement('div', { className: 'bg-cyan-500 rounded-2xl p-6 text-white' },
                                React.createElement(Percent, { size: 32, className: 'mb-2' }),
                                React.createElement('p', { className: 'text-3xl font-bold' }, disc),
                                React.createElement('p', null, 'Discounts')
                            ),
                            React.createElement('div', { className: 'bg-green-500 rounded-2xl p-6 text-white' },
                                React.createElement(Gift, { size: 32, className: 'mb-2' }),
                                React.createElement('p', { className: 'text-3xl font-bold' }, fr),
                                React.createElement('p', null, 'Free Loads')
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-2xl p-6 mb-6' },
                            React.createElement('h2', { className: 'text-xl font-bold mb-4' }, 'Quick Scan'),
                            React.createElement('div', { className: 'flex gap-3' },
                                React.createElement('input', {
                                    type: 'text',
                                    value: scan,
                                    onChange: (e) => setScan(e.target.value),
                                    placeholder: 'Phone number',
                                    className: 'flex-1 px-4 py-3 border-2 rounded-xl'
                                }),
                                React.createElement('button', {
                                    onClick: () => {
                                        const p = scan.replace(/\D/g, '');
                                        if (customers[p]) {
                                            add(p);
                                            setScan('');
                                            alert('Stamp added!');
                                        } else alert('Not found');
                                    },
                                    className: 'bg-blue-500 text-white px-6 py-3 rounded-xl flex items-center gap-2'
                                }, React.createElement(ScanLine, { size: 20 }), 'Add')
                            )
                        ),
                        React.createElement('div', { className: 'bg-white rounded-2xl overflow-hidden' },
                            React.createElement('div', { className: 'p-6 border-b' },
                                React.createElement('h2', { className: 'text-xl font-bold' }, 'All Customers')
                            ),
                            tot === 0 ? React.createElement('div', { className: 'text-center py-12 text-gray-500' },
                                React.createElement(Users, { size: 64, className: 'mx-auto mb-4 opacity-50' }),
                                React.createElement('p', null, 'No customers')
                            ) : React.createElement('table', { className: 'w-full' },
                                React.createElement('thead', { className: 'bg-gray-50' },
                                    React.createElement('tr', null,
                                        React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase' }, 'Customer'),
                                        React.createElement('th', { className: 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase' }, 'Phone'),
                                        React.createElement('th', { className: 'px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase' }, 'Stamps'),
                                        React.createElement('th', { className: 'px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase' }, 'Actions')
                                    )
                                ),
                                React.createElement('tbody', { className: 'divide-y' },
                                    Object.values(customers).map(c =>
                                        React.createElement('tr', { key: c.phone, className: 'hover:bg-gray-50' },
                                            React.createElement('td', { className: 'px-6 py-4' },
                                                React.createElement('div', { className: 'flex items-center gap-3' },
                                                    React.createElement('div', { className: 'w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold' }, c.name.charAt(0)),
                                                    React.createElement('span', { className: 'font-medium' }, c.name)
                                                )
                                            ),
                                            React.createElement('td', { className: 'px-6 py-4 text-gray-600' }, c.phone),
                                            React.createElement('td', { className: 'px-6 py-4 text-center' },
                                                React.createElement('span', { className: 'bg-blue-100 text-blue-800 px-3 py-1 rounded-full font-semibold' }, c.stamps)
                                            ),
                                            React.createElement('td', { className: 'px-6 py-4' },
                                                React.createElement('div', { className: 'flex items-center justify-center gap-2' },
                                                    React.createElement('button', { onClick: () => add(c.phone), className: 'bg-green-500 text-white p-2 rounded-lg' }, React.createElement(Plus, { size: 16 })),
                                                    React.createElement('button', { onClick: () => remove(c.phone), className: 'bg-orange-500 text-white p-2 rounded-lg' }, React.createElement(Minus, { size: 16 })),
                                                    React.createElement('button', { onClick: () => del(c.phone), className: 'bg-red-500 text-white p-2 rounded-lg' }, React.createElement(Trash2, { size: 16 }))
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )
                );
            }

            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
